# Docs2DB-API RAG + Llama Stack Demo

This directory contains comprehensive demonstrations of Docs2DB-API RAG integration with Llama Stack.

| File | Purpose |
|------|---------|
| `setup_fresh_llama_stack.py` | **Setup script** - Creates an isolated Llama Stack installation with Docs2DB RAG preconfigured as a tool provider |
| `start_server.py` | **Server script** - starts Llama Stack server (Generated by `setup_fresh_llama_stack.py` in the directory it creates) |
| `client.py` | **Direct tool demo** - Calls the Llama Stack RAG tool directly to verify functionality |
| `agent_tool_calling_client.py` | **Agent tool demo** - Creates and runs a Llama Stack agent that calls RAG using tool calling |

## Quick Start

### 1. Setup Environment

Create a fresh Llama Stack environment with Docs2DB-API RAG:

```bash
# Basic setup (for direct tool calling)
python setup_fresh_llama_stack.py my-demo-dir
```

### 2. Start Server

```bash
cd my-demo-dir
uv run python start_server.py
```

### 3. Run Demos

**Direct Tool Calling Demo:**
```bash
python client.py
```

**Agent Tool Calling Demo:**
```bash
python agent_tool_calling_client.py
```

## Details

### Setup (`setup_fresh_llama_stack.py`)

Creates an isolated installation of Llama Stack with Docs2DB-API RAG preconfigured as a tool runtime provider. The script sets up a complete uv-managed Python environment with all dependencies, configures the RAG provider in `docs2db_rag.yaml`, and creates a distribution config that includes the `docs2db::rag` tool group. In the created directory, notice the `docs2db-distribution-local.yaml` file which defines the complete stack configuration, and `start_server.py` which launches the configured Llama Stack server.

### Direct Tool Calling (`client.py`)
- Calls `search_documents` tool directly via `tool_runtime.invoke_tool()`

### Agent Tool Calling (`agent_tool_calling_client.py`)
- Creates a Llama Stack agent that can call the `docs2db::rag` tool
- Queries this new agent, which uses tool-calling to call the RAG tool

## Setup Details

### Environment Requirements

- **Python 3.12+** with `uv` package manager
- **Ollama** running locally (port 11434) with `qwen2.5:7b-instruct` model
- **Docs2DB** database populated with documentation

### What `setup_fresh_llama_stack.py` Does

1. **Creates isolated environment** - Fresh directory with `uv` virtual environment
2. **Installs dependencies** - `llama-stack`, `llama-stack-client`, and all required packages
3. **Installs Docs2DB RAG** - Editable install with specific dependencies
4. **Configures providers** - Sets up Docs2DB RAG as Llama Stack tool runtime provider
5. **Creates distribution** - YAML configuration for Ollama + Docs2DB RAG integration
6. **Generates startup script** - Ready-to-use server startup script `start_server.py`
